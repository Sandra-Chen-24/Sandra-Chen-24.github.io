<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Kube-Dns on Sandra Chen Blog</title><link>https://sandra-chen-24.github.io/categories/kube-dns/</link><description>Recent content in Kube-Dns on Sandra Chen Blog</description><generator>Hugo -- gohugo.io</generator><language>zh-tw</language><lastBuildDate>Wed, 17 Sep 2025 15:30:00 +0800</lastBuildDate><atom:link href="https://sandra-chen-24.github.io/categories/kube-dns/index.xml" rel="self" type="application/rss+xml"/><item><title>kube-dns</title><link>https://sandra-chen-24.github.io/blog/kube-dns/kube-dns/</link><pubDate>Wed, 17 Sep 2025 15:30:00 +0800</pubDate><guid>https://sandra-chen-24.github.io/blog/kube-dns/kube-dns/</guid><description>&lt;h2 id="nodelocaldns"&gt;NodeLocalDNS
&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;dnsmasq_hits_count è·Ÿ dnsmasq_misses_count ä¸»è¦ç”¨ä¾†åæ˜ å¿«å–æ•ˆç›Šï¼Œå‘½ä¸­å°±ä¸éœ€è¦å¾€ä¸Šæ¸¸ CoreDNS/KubeDNS æˆ–å¤–éƒ¨ DNS æŸ¥&lt;/li&gt;
&lt;li&gt;dnsmasq_hits_count / (dnsmasq_hits_count + dnsmasq_misses_count) * 100
-&amp;gt; å¦‚æœå‘½ä¸­ç‡ &amp;gt; 80%ï¼Œä»£è¡¨å¤§éƒ¨åˆ†çš„æŸ¥è©¢éƒ½è¢«å¿«å–è§£æ±º&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="kube-dns-autoscaler-çš„è¨­å®š"&gt;kube-dns-autoscaler çš„è¨­å®š
&lt;/h2&gt;&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"&gt;&lt;code class="language-yaml" data-lang="yaml"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#f92672"&gt;apiVersion&lt;/span&gt;: &lt;span style="color:#ae81ff"&gt;v1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#f92672"&gt;kind&lt;/span&gt;: &lt;span style="color:#ae81ff"&gt;ConfigMap&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#f92672"&gt;metadata&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#f92672"&gt;name&lt;/span&gt;: &lt;span style="color:#ae81ff"&gt;kube-dns-autoscaler&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#f92672"&gt;namespace&lt;/span&gt;: &lt;span style="color:#ae81ff"&gt;kube-system&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#f92672"&gt;data&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#f92672"&gt;linear&lt;/span&gt;: |-&lt;span style="color:#e6db74"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#e6db74"&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#e6db74"&gt; &amp;#34;coresPerReplica&amp;#34;: 256,
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#e6db74"&gt; &amp;#34;nodesPerReplica&amp;#34;: 16,
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#e6db74"&gt; &amp;#34;min&amp;#34;: 2,
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#e6db74"&gt; &amp;#34;max&amp;#34;: 20
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#e6db74"&gt; }&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#f92672"&gt;ğŸ”¹ coresPerReplica&lt;/span&gt;: &lt;span style="color:#ae81ff"&gt;æ¯å¤šå°‘å€‹ CPU Core éœ€è¦æ–°å¢ä¸€å€‹ CoreDNS å‰¯æœ¬&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#f92672"&gt;ğŸ”¹ nodesPerReplica&lt;/span&gt;: &lt;span style="color:#ae81ff"&gt;æ¯å¤šå°‘å€‹ Node éœ€è¦æ–°å¢ä¸€å€‹å‰¯æœ¬&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#ae81ff"&gt;ğŸ‘‰ autoscaler æœƒå–å…©è€…ä¸­ éœ€è¦å‰¯æœ¬æ•¸è¼ƒå¤šçš„é‚£å€‹å€¼&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#f92672"&gt;ğŸ”¹ min&lt;/span&gt;: &lt;span style="color:#ae81ff"&gt;kube-dns/CoreDNS æœ€å°‘å‰¯æœ¬æ•¸ (é¿å…éå°é›†ç¾¤ç„¡æ³•å®¹éŒ¯)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#f92672"&gt;ğŸ”¹ max&lt;/span&gt;: &lt;span style="color:#ae81ff"&gt;kube-dns/CoreDNS æœ€å¤§å‰¯æœ¬æ•¸ (é¿å…å¤ªå¤š pod æµªè²»è³‡æº)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#ae81ff"&gt;ğŸ“Œ å¯¦éš›ä¾‹å­&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#ae81ff"&gt;å‡è¨­ä½ çš„ cluster æœ‰ï¼š&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#ae81ff"&gt;640&lt;/span&gt; &lt;span style="color:#ae81ff"&gt;cores / 80 nodes&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#ae81ff"&gt;è¨ˆç®—ï¼š&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#ae81ff"&gt;coresPerReplica = 256 â†’ 640 / 256 = 3 å‰¯æœ¬&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#ae81ff"&gt;nodesPerReplica = 16 â†’ 80 / 16 = 5 å‰¯æœ¬&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#ae81ff"&gt;ğŸ‘‰ autoscaler é¸å– 5 å‰¯æœ¬ (å› ç‚ºè¦æ»¿è¶³å…©å€‹æ¢ä»¶ä¸­è¼ƒå¤§çš„éœ€æ±‚)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</description></item></channel></rss>